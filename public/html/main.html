<!DOCTYPE html>
<html lang="en">

<head>
    <title>three.js webgl - scenes transition</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <style>
    body {
        font-family: Monospace;
        background-color: #f0f0f0;
        margin: 0px;
        overflow: hidden;
    }
    
    .info {
        position: absolute;
        background-color: black;
        opacity: 0.8;
        color: white;
        text-align: center;
        top: 0px;
        width: 100%;
    }
    
    .info a {
        color: #00ffff;
    }
    </style>
</head>

<body>
    <div id="container"></div>
    <script src="../js/lib/three.js"></script>
    <script src="../js/audio/AudioManager.js"></script>
    <script src="../js/animation/crossfade/scenes.js"></script>
    <script src="../js/animation/crossfade/SceneManager.js"></script>
    <script src="../js/animation/controls/PointerLockControls.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tween.js/16.3.5/Tween.min.js"></script>

    <script>
    var renderer;
    var sceneManager;

    var clock = new THREE.Clock();
    var cameras = [];
    var controls = [];
    var scenes = [];
    var SCENES_COUNT = 5;
    var audioManager = new AudioManager();

    init();
    animate();

    function init() {
        for (var i = 0; i < SCENES_COUNT; i++) {
            cameras[i] = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 1, 1000);
            //controls[i] = new THREE.FirstPersonControls(cameras[i]);
            controls[i] = new THREE.PointerLockControls(cameras[i]);
            //controls[i] .movementSpeed = 100;
            //controls[i] .lookSpeed = 0.1;
        }

        var container = document.getElementById("container");

        renderer = new THREE.WebGLRenderer({
            antialias: true
        });
        renderer.setPixelRatio(window.devicePixelRatio);
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.sortObjects = false;
        container.appendChild(renderer.domElement);

        scenes.push(new Scene("mainScene", 0xFFFFFF, controls[0], cameras[0]));
        scenes.push(new Scene("musicScene", 0x000000, controls[1], cameras[1]));
        scenes.push(new Scene("mainScene", 0x0000FF, controls[2], cameras[2]));
        scenes.push(new Scene("mainScene", 0xFF0000, controls[3], cameras[3]));
        scenes.push(new Scene("mainScene", 0xFFFF00, controls[4], cameras[4]));

        sceneManager = new SceneManager(scenes);
    }

    function animate() {
        requestAnimationFrame(animate);
        updateControls();
        render();
        TWEEN.update();
    }


    function updateControls() {
        for (var i = 0; i < SCENES_COUNT; i++) {
            controls[i].update(clock.getDelta());
        }
    }

    function render() {
        sceneManager.render(clock.getDelta());
    }
    </script>
</body>

</html>
